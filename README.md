# Transfer Learning Application on Cross-Subject Emotion Recognition
This is a repository for the project of CS3507. I have implemented 4 different models with transfer learning methods for a cross-subject emotion recognition task.
- Domain Generalization Models
  - IBN_ResNet18
  - MixStyle_CNN
- Domain Adaptation Models
  - ADDA
  - DANN
---
## Install
```bash
pip install -r requirements.txt
```
## How to run
1. First, we need to put the [SEED-IV](https://bcmi.sjtu.edu.cn/~seed/seed-iv.html) dataset at path `./data/SEED-IV/SEED-IV`
2. Second, we need to use `make_dataset.py` to build the datasets we need.
   -  Build all datasets we need.
        ```bash
        python make_dataset.py
        ``` 
   - Build `./data/SEED-IV_concatenate_unfold` for SVM, MLP, ADDA and DANN.
        ```bash
        python make_dataset.py --mode unfold
        ``` 
   - Build `./data/SEED-IV_concatenate_reshape` for CNN, ResNet18, IBN_ResNet18 and MixStyle_CNN.
        ```bash
        python make_dataset.py --mode reshape
        ``` 
3. Third, we provide each model a `train.py` script to train the model.
   - Baseline models
        ```bash
        python ./source/Baseline/SVM/train.py
        python ./source/Baseline/MLP/train.py
        python ./source/Baseline/CNN/train.py
        python ./source/Baseline/ResNet18/train.py
        ```
   - DG models
        ```bash
        python ./source/DG/IBN_ResNet18/train.py
        python ./source/DG/MixStyle_CNN/train.py
        ```
   - DA models
        ```bash
        python ./source/DA/ADDA/train.py
        python ./source/DA/DANN/train.py
        ```
4. Forth, we provide each model a `test.py` script to test the model at `./model` generated by step 3.
   ```bash
   python [path to source code]/test.py --path [path to model files]
   ```
---
You can also find the experiment result (both logs and models) at <a href="https://jbox.sjtu.edu.cn/l/i1Nkpa"><img src="https://jbox.sjtu.edu.cn/v2/config/get_file?config_type=0&config_id=0&name=custom_main_logo" width="80"></a>.